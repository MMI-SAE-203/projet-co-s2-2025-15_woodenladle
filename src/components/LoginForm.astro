---

---

<form id="loginForm" class="bg-white p-6 rounded shadow w-80">
    <h2 class="text-xl mb-4 font-bold">Connexion</h2>
    <label class="block mb-2">
        Email
        <input type="email" name="email" required class="w-full p-2 border" />
    </label>
    <label class="block mb-4">
        Mot de passe
        <input
            type="password"
            name="password"
            required
            class="w-full p-2 border"
        />
    </label>
    <button type="submit" class="bg-blue-500 text-white px-4 py-2 rounded"
        >Se connecter</button
    >
    <p id="error" class="text-red-500 mt-2 hidden"></p>
</form>

<script is:browser>
    const form = document.getElementById("loginForm");

    form.addEventListener("submit", async (e) => {
        e.preventDefault();

        const formData = new FormData(form);
        const email = formData.get("email");
        const password = formData.get("password");

        const res = await fetch("/api/login", {
            method: "POST",
            headers: {
                "Content-Type": "application/json",
            },
            body: JSON.stringify({ email, password }),
        });

        const result = await res.json();

        if (res.ok) {
            localStorage.setItem("user", JSON.stringify(result.user)); // âœ… stockage ici
            window.location.href = "/"; // ou /profil selon ton besoin
        } else {
            alert(result.error || "Erreur de connexion");
        }
    });
</script>
